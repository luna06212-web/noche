<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Rosas Nocturnas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: radial-gradient(circle at bottom, #07081a, #000);
}
canvas {
    display: block;
}
</style>
</head>

<body>
<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let dpr, cw, ch, groundY;

function resize() {
    dpr = Math.min(window.devicePixelRatio, 2);
    cw = window.innerWidth;
    ch = window.innerHeight;

    canvas.width = cw * dpr;
    canvas.height = ch * dpr;
    canvas.style.width = cw + "px";
    canvas.style.height = ch + "px";

    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

    groundY = ch * 0.85; // SIEMPRE visible en mÃ³vil
}
resize();
window.addEventListener("resize", resize);

let time = 0;

/* â­ ESTRELLAS */
const stars = Array.from({ length: 160 }, () => ({
    x: Math.random() * cw,
    y: Math.random() * ch * 0.6,
    a: Math.random() * 0.8
}));

function drawStars() {
    stars.forEach(s => {
        ctx.fillStyle = `rgba(255,255,255,${s.a})`;
        ctx.fillRect(s.x, s.y, 1.3, 1.3);
        s.a += (Math.random() - 0.5) * 0.01;
    });
}

/* â˜„ï¸ COMETAS SUTILES */
let shootingStars = [];

function createShootingStar() {
    shootingStars.push({
        x: Math.random() * cw,
        y: Math.random() * ch * 0.4,
        vx: 6,
        vy: 3,
        life: 35
    });
}

function drawShootingStars() {
    shootingStars.forEach((s, i) => {
        ctx.strokeStyle = "rgba(180,220,255,0.35)";
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(s.x, s.y);
        ctx.lineTo(s.x - 30, s.y - 15);
        ctx.stroke();

        s.x += s.vx;
        s.y += s.vy;
        s.life--;

        if (s.life <= 0) shootingStars.splice(i, 1);
    });

    if (Math.random() < 0.006) createShootingStar();
}

/* ðŸŒ™ LUNA (NO SE TOCA) */
function drawMoon() {
    const x = cw - 130;
    const y = 130;
    const r = 46;

    const grad = ctx.createRadialGradient(
        x - 10, y - 10, r * 0.2,
        x, y, r
    );
    grad.addColorStop(0, "#ffffff");
    grad.addColorStop(1, "#cfd6ff");

    ctx.beginPath();
    ctx.arc(x, y, r, 0, Math.PI * 2);
    ctx.fillStyle = grad;
    ctx.shadowColor = "#9fb6ff";
    ctx.shadowBlur = 35;
    ctx.fill();
    ctx.shadowBlur = 0;

    ctx.beginPath();
    ctx.arc(x + 18, y - 8, r, 0, Math.PI * 2);
    ctx.fillStyle = "rgba(0,0,0,0.15)";
    ctx.fill();
}

/* ðŸŒ¹ ROSAS MÃS GRUESAS */
class Rose {
    constructor(x) {
        this.baseX = x;
        this.stem = 0;
        this.maxStem = 130 + Math.random() * 30;
        this.phase = Math.random() * Math.PI * 2;
        this.color = ["#ff4f9a", "#ff2f7d", "#ff77b7"][Math.floor(Math.random()*3)];
    }

    update() {
        this.phase += 0.01;
        const sway = Math.sin(this.phase + time * 0.01) * 4;

        if (this.stem < this.maxStem) {
            this.stem += 0.9;
        }

        /* TALLO MUY GRUESO */
        ctx.strokeStyle = "#2f9a6a";
        ctx.lineWidth = 5.5;
        ctx.beginPath();
        ctx.moveTo(this.baseX, groundY + 10);
        ctx.lineTo(this.baseX + sway, groundY - this.stem);
        ctx.stroke();

        if (this.stem < 30) return;

        /* CAPULLO GRANDE */
        ctx.save();
        ctx.translate(this.baseX + sway, groundY - this.stem);
        ctx.rotate(Math.sin(this.phase) * 0.1);

        ctx.shadowColor = this.color;
        ctx.shadowBlur = 24;

        for (let i = 0; i < 11; i++) {
            ctx.rotate(Math.PI / 5.5);
            ctx.beginPath();
            ctx.ellipse(0, -10, 8.5, 18, 0, 0, Math.PI * 2);
            ctx.fillStyle = this.color;
            ctx.fill();
        }

        ctx.beginPath();
        ctx.arc(0, 0, 5, 0, Math.PI * 2);
        ctx.fillStyle = "#ffe";
        ctx.fill();

        ctx.restore();
    }
}

/* MÃS FLORES */
const roses = [];
const count = cw < 600 ? 7 : 12;
for (let i = 0; i < count; i++) {
    roses.push(new Rose(60 + i * (cw / count)));
}

/* ðŸŒ TIERRA */
function drawGround() {
    ctx.fillStyle = "#1a120d";
    ctx.fillRect(0, groundY, cw, ch);
}

/* LOOP */
function animate() {
    ctx.clearRect(0, 0, cw, ch);
    time++;

    drawStars();
    drawShootingStars();
    drawMoon();
    drawGround();
    roses.forEach(r => r.update());

    requestAnimationFrame(animate);
}
animate();
</script>
</body>
</html>
